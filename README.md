# dismember

A simple membership and payments web application for Splat Space.

# Installation and Configuration

dismember is a Node.js application that serves HTTP directly.  You could put it
behind a reverse proxy like Apache or nginx, or have it bind to a publically 
accessible port.

## Required Software

- Node.js 0.10.26+
- npm 1.3.4+
- PostgreSQL 9.1+

## Setup

First let npm install the dependencies:

    npm install

You might need the PostgreSQL development packages installed to complete
the installation of the "pg" module.

Once the dependencies are installed, copy the config file template and
edit it:

    cp config/config.js.template config/config.js
    vi config/config.js

Edit the config.js file to suit your needs.

### Behind an HTTP Reverse Proxy?

If you want to serve dismember through a reverse proxy, you must configure the
proxy to preserve the original request host name.  Dismember needs to know the
original host name in order to format absolute callback URIs to send to 
WePay.  Apache's `ProxyPreserveHost On` directive takes care of this.

If you want your reverse proxy to serve dismember at a non-root
path, like `/dismember`, you must set `config.uriPathPrefix` to that path
in your config.js file.  If you don't set it, stylesheets won't load
and hyperlinks generated by the application will be wrong.

## Starting the Application

Once you've configured the application, you can start it up with npm:

    npm start

The application will automatically create its database schema when it
starts.

## Running as a Service

On Ubuntu systems, use [upstarter](https://www.npmjs.org/package/upstarter)
to quickly generate an upstart script in /etc/init.  When prompted for commands
to run, enter `npm start`.  You you get to choose the description and the other
settings.

On other systems, you'll have to write your own init scripts, but
`cd /where/you/installed/it && npm start` is the critical part.