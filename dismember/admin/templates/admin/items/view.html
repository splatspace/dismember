{% extends "_common/base.html" %}
{% import 'admin/items/_macros.html' as macros %}
{% block head %}
    <title>{{ item_name }} - {{ config['DISMEMBER_SITE_NAME'] }}</title>

    <script>
        function delete_item(url, name, success_url) {
            if (window.confirm('Delete ' + name + '?')) {
                $.ajax({
                    type: 'DELETE',
                    url: url,
                    success: function () {
                        location.href = success_url
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert(textStatus + ':' + errorThrown);
                    }
                });
            }
        }
    </script>
{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-md-12">
            <h3>{{ item_name }}</h3>
        </div>
    </div>

    <form class="form-group" action="{{ url_for(update_endpoint, item_id=item.id) }}" method="post">
        <fieldset>
            {% for field in form %}
                {{ macros.render_field(field) }}
            {% endfor %}

            <div class="row">
                <div class="col-md-12">
                    <div class="btn-toolbar">
                        <div class="btn-group">
                            <button type="submit" class="btn btn-info">Save</button>
                            <button type="button" class="btn btn-default" onclick="history.back();">Cancel</button>
                        </div>
                        <div class="btn-group pull-right">
                            <button type="button"
                                    class="btn btn-danger"
                                    onclick="delete_item(
                                            '{{ url_for(delete_endpoint, item_id=item.id) }}',
                                            '{{ item|string }}',
                                            '{{ url_for(list_endpoint) }}'
                                            )">
                                Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </fieldset>
    </form>

{% endblock %}

